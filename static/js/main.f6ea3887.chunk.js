(this.webpackJsonpacuity=this.webpackJsonpacuity||[]).push([[0],{22:function(t,e,a){},23:function(t,e,a){},27:function(t,e,a){"use strict";a.r(e);var n=a(1),r=a.n(n),c=a(14),s=a.n(c),i=(a(22),a(23),a(3)),o=a(2),u=a.n(o),l=a(4),d=a(15),b=a(6),h=a(7),j=a(5),f=a(10),O=a(9),v=a(16),p=a.n(v),m=a(17),k=a(8),y=a.n(k),x=new TextDecoder,w=function(t){Object(f.a)(a,t);var e=Object(O.a)(a);function a(){var t;Object(b.a)(this,a),(t=e.call(this)).socket=void 0,t.ready=void 0;var n=new p.a("wss://real.okex.com:8443/ws/v3");return n.binaryType="arraybuffer",t.ready=new Promise((function(t){n.onopen=function(){t()}})),n.onmessage=t._handleMessage.bind(Object(j.a)(t)),t.socket=n,t}return Object(h.a)(a,[{key:"_handleMessage",value:function(){var t=Object(l.a)(u.a.mark((function t(e){var a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=this._decodeMessage(e),this.emit("data",a);case 2:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"_decodeMessage",value:function(t){var e=new Uint8Array(t.data),a=m.a(e),n=x.decode(a);return JSON.parse(n)}},{key:"send",value:function(t){this.socket.send(JSON.stringify(t))}}]),a}(y.a),g=function(t){Object(f.a)(a,t);var e=Object(O.a)(a);function a(t,n,r){var c;return Object(b.a)(this,a),(c=e.call(this)).socket=t,c.instrumentId=r,c.data=void 0,c.table=void 0,c.data={bids:new Map,asks:new Map},c.table="".concat(n,"/depth_l2_tbt"),t.on("data",c._handleData.bind(Object(j.a)(c))),c}return Object(h.a)(a,[{key:"_handleData",value:function(t){var e=this,a=this.table,n=this.instrumentId,r=this.data,c=r.asks,s=r.bids;t.table===a&&t.data.forEach((function(a){a.instrument_id===n&&("partial"!==t.action&&"update"!==t.action||(a.asks.forEach((function(t){var e=parseFloat(t[0]),a=parseFloat(t[1]);"0"===t[1]?c.delete(e):c.set(e,a)})),a.bids.forEach((function(t){var e=parseFloat(t[0]),a=parseFloat(t[1]);"0"===t[1]?s.delete(e):s.set(e,a)})),e.emit("data",r)))}))}},{key:"subscribe",value:function(){var t=Object(l.a)(u.a.mark((function t(){var e,a,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.table,a=this.instrumentId,n={op:"subscribe",args:["".concat(e,":").concat(a)]},this.socket.send(n);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),a}(y.a),C=function(t){Object(f.a)(a,t);var e=Object(O.a)(a);function a(t,n,r){var c;return Object(b.a)(this,a),(c=e.call(this)).socket=t,c.instrumentId=r,c.table=void 0,c.table="".concat(n,"/ticker"),t.on("data",c._handleData.bind(Object(j.a)(c))),c}return Object(h.a)(a,[{key:"_handleData",value:function(t){var e=this,a=this.table,n=this.instrumentId;t.table===a&&t.data.forEach((function(t){t.instrument_id===n&&e.emit("data",{last:parseFloat(t.last)})}))}},{key:"subscribe",value:function(){var t=Object(l.a)(u.a.mark((function t(){var e,a,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.table,a=this.instrumentId,n={op:"subscribe",args:["".concat(e,":").concat(a)]},this.socket.send(n);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),a}(y.a),_=a(29),M=a(30),E=a(31),I=function(t){Object(f.a)(a,t);var e=Object(O.a)(a);function a(t,n,r){var c;return Object(b.a)(this,a),(c=e.call(this)).socket=t,c.instrumentId=r,c.table=void 0,c.table="".concat(n,"/mark_price"),t.on("data",c._handleData.bind(Object(j.a)(c))),c}return Object(h.a)(a,[{key:"_handleData",value:function(t){var e=this,a=this.table,n=this.instrumentId;t.table===a&&t.data.forEach((function(t){t.instrument_id===n&&e.emit("data",{mark:parseFloat(t.mark_price)})}))}},{key:"subscribe",value:function(){var t=Object(l.a)(u.a.mark((function t(){var e,a,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.table,a=this.instrumentId,n={op:"subscribe",args:["".concat(e,":").concat(a)]},this.socket.send(n);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),a}(y.a);function S(t,e,a){var n,r=new Map,c=Object(d.a)(t);try{for(c.s();!(n=c.n()).done;){var s=Object(i.a)(n.value,2),o=s[0],u=s[1],l=e(o/a)*a;r.set(l,(r.get(l)||0)+u)}}catch(b){c.e(b)}finally{c.f()}return Array.from(r.entries())}function N(t,e){var a=0;return t.map((function(t){var n=Object(i.a)(t,2),r=n[0],c=n[1];return[r,c,a+=c,100*a/e]}))}var D=function(t,e,a){var r=Object(n.useState)({bids:[],asks:[]}),c=Object(i.a)(r,2),s=c[0],o=c[1],d=Object(_.a)({last:0,mark:0}),b=Object(i.a)(d,2),h=b[0],j=b[1],f=Object(M.a)((function(t,e){var a=S(t.asks,Math.ceil,e).slice(0,6),n=S(t.bids,Math.floor,e).slice(-6),r=t.asks.reduce((function(t,e){return t+Object(i.a)(e,2)[1]}),0),c=t.asks.reduce((function(t,e){return t+Object(i.a)(e,2)[1]}),0);return{asks:N(a,r).reverse(),bids:N(n.reverse(),c)}}),250,[s,a]),O=Object(E.a)(h,10);return Object(n.useEffect)((function(){Object(l.a)(u.a.mark((function a(){var n,r,c,s;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=new w,r=new g(n,t,e),c=new C(n,t,e),s=new I(n,t,e),a.next=6,n.ready;case 6:r.on("data",(function(t){o({asks:Array.from(t.asks.entries()).sort(),bids:Array.from(t.bids.entries()).sort()})})),r.subscribe(),s.on("data",(function(t){return j({mark:t.mark})})),s.subscribe(),c.on("data",(function(t){return j({last:t.last})})),c.subscribe();case 12:case"end":return a.stop()}}),a)})))()}),[t,e,o,j]),{orders:f,market:O}};function F(){return(F=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t}).apply(this,arguments)}function A(t,e){if(null==t)return{};var a,n,r=function(t,e){if(null==t)return{};var a,n,r={},c=Object.keys(t);for(n=0;n<c.length;n++)a=c[n],e.indexOf(a)>=0||(r[a]=t[a]);return r}(t,e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);for(n=0;n<c.length;n++)a=c[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}var T=n.createElement("path",{fill:"currentColor",d:"M6,3A1,1 0 0,1 7,4V4.88C8.06,4.44 9.5,4 11,4C14,4 14,6 16,6C19,6 20,4 20,4V12C20,12 19,14 16,14C13,14 13,12 11,12C8,12 7,14 7,14V21H5V4A1,1 0 0,1 6,3M7,7.25V11.5C7,11.5 9,10 11,10C13,10 14,12 16,12C18,12 18,11 18,11V7.5C18,7.5 17,8 16,8C14,8 13,6 11,6C9,6 7,7.25 7,7.25Z"});function V(t,e){var a=t.title,r=t.titleId,c=A(t,["title","titleId"]);return n.createElement("svg",F({viewBox:"0 0 24 24",ref:e,"aria-labelledby":r},c),a?n.createElement("title",{id:r},a):null,T)}var P=n.forwardRef(V),J=(a.p,a(0)),B=[.5,1,2,5],H=function(){var t=Object(n.useState)(.5),e=Object(i.a)(t,2),a=e[0],r=e[1],c=D("futures","BTC-USD-210625",a),s=c.market,o=c.orders||{asks:[],bids:[]},u=o.asks,l=o.bids,d=s.last,b=s.mark;return Object(J.jsxs)("div",{className:"order-book",children:[Object(J.jsxs)("div",{className:"title",children:[Object(J.jsx)("h5",{children:"Order book"}),Object(J.jsxs)("div",{className:"depth",children:[Object(J.jsx)("label",{htmlFor:"depth",children:"Depth"}),Object(J.jsx)("select",{name:"depth",value:a,onChange:function(t){return r(parseFloat(t.target.value))},children:B.map((function(t){return Object(J.jsx)("option",{value:t,children:t},t.toString())}))})]})]}),Object(J.jsxs)("table",{children:[Object(J.jsx)("thead",{children:Object(J.jsxs)("tr",{children:[Object(J.jsx)("th",{children:"Price"}),Object(J.jsx)("th",{children:"Qty"}),Object(J.jsx)("th",{children:"Total"})]})}),Object(J.jsx)("tbody",{className:"asks",children:u.map((function(t){var e=Object(i.a)(t,4),a=e[0],n=e[1],r=e[2],c=e[3];return Object(J.jsxs)("tr",{children:[Object(J.jsx)("td",{children:a}),Object(J.jsx)("td",{children:n}),Object(J.jsxs)("td",{className:"progress",children:[Object(J.jsx)("div",{style:{width:"".concat(c,"%")}}),r]})]},a.toString())}))}),Object(J.jsx)("tbody",{className:"market",children:Object(J.jsxs)("tr",{children:[Object(J.jsx)("td",{children:d}),Object(J.jsxs)("td",{className:"mark",children:[Object(J.jsx)(P,{}),b]}),Object(J.jsx)("td",{})]})}),Object(J.jsx)("tbody",{className:"bids",children:l.map((function(t){var e=Object(i.a)(t,4),a=e[0],n=e[1],r=e[2],c=e[3];return Object(J.jsxs)("tr",{children:[Object(J.jsx)("td",{children:a}),Object(J.jsx)("td",{children:n}),Object(J.jsxs)("td",{className:"progress",children:[Object(J.jsx)("div",{style:{width:"".concat(c,"%")}}),r]})]},a.toString())}))})]})]})};var U=function(){return Object(n.useEffect)((function(){var t;console.log("???");var e=document.createElement("template");e.innerHTML='<meta property="og:title"              content="When Great Minds Don\u2019t Think Alike" />',e.content.firstChild&&(null===(t=document.querySelector("head"))||void 0===t||t.appendChild(e.content.firstChild))}),[]),Object(J.jsx)(H,{})};s.a.render(Object(J.jsx)(r.a.StrictMode,{children:Object(J.jsx)(U,{})}),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.f6ea3887.chunk.js.map